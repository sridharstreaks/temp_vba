Function FindWindowByName(windowName As String) As Long
  ' Finds a window by its name and returns its handle (hWnd).
  ' Returns 0 if the window is not found.

  Dim hWnd As Long
  Dim currentWindowName As String
  Dim currentWindowLength As Long

  hWnd = FindWindow(vbNullString, windowName)

  If hWnd = 0 Then
    'Try finding the window with a partial match if the exact match fails
    hWnd = FindWindow(vbNullString, vbNullString) 'Start with the first window
    Do While hWnd <> 0
        currentWindowLength = GetWindowTextLength(hWnd) + 1
        currentWindowName = String$(currentWindowLength, 0)
        GetWindowText hWnd, currentWindowName, currentWindowLength

        If InStr(1, currentWindowName, windowName, vbTextCompare) > 0 Then
            Exit Do 'Found a window with the provided string in it's name.
        End If

        hWnd = FindWindowEx(0, hWnd, vbNullString, vbNullString) 'Get the next window.
    Loop

  End If

  FindWindowByName = hWnd

End Function

' Example Usage:
Sub ExampleFindWindow()
  Dim targetWindowHandle As Long
  Dim windowTitle As String

  windowTitle = "Calculator" ' Replace with the actual window name

  targetWindowHandle = FindWindowByName(windowTitle)

  If targetWindowHandle <> 0 Then
    MsgBox "Window '" & windowTitle & "' found. Handle: " & targetWindowHandle
    ' You can now use the handle to interact with the window.
    ' For example, to bring it to the foreground:
    ' SetForegroundWindow targetWindowHandle
  Else
    MsgBox "Window '" & windowTitle & "' not found."
  End If

End Sub

'API Declarations (Place these at the top of your module):
Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Private Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWndParent As Long, ByVal hWndChildAfter As Long, ByVal lpszClass As String, ByVal lpszWindow As String) As Long
Private Declare Function GetWindowText Lib "user32" Alias "GetWindowTextA" (ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long
Private Declare Function GetWindowTextLength Lib "user32" Alias "GetWindowTextLengthA" (ByVal hWnd As Long) As Long
Private Declare Function SetForegroundWindow Lib "user32" (ByVal hWnd As Long) As Long

