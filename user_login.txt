Sub RunCmdWithInteractivePassword()
    Dim WshShell As Object
    Set WshShell = CreateObject("WScript.Shell")
    
    Dim cmdPath As String
    ' Specify the full path to your CMD file.
    cmdPath = "C:\YourFolder\YourScript.cmd"
    
    Dim oExec As Object
    ' Launch the CMD file and obtain the Exec object.
    Set oExec = WshShell.Exec(cmdPath)
    
    Dim sLine As String
    Dim passwordPromptDetected As Boolean
    passwordPromptDetected = False
    
    ' Loop while the process is running.
    Do While oExec.Status = 0
        ' Process any available standard output.
        Do While Not oExec.StdOut.AtEndOfStream
            sLine = oExec.StdOut.ReadLine
            Debug.Print sLine  ' You can log or display the output as needed.
            
            ' Check if the output contains the password prompt.
            If InStr(sLine, "Enter password") > 0 Then
                passwordPromptDetected = True
                Dim userPassword As String
                userPassword = InputBox("Please enter the password:", "Password Required")
                ' Write the entered password followed by a newline.
                oExec.StdIn.WriteLine userPassword
            End If
            
            ' Optionally check for error messages in the output.
            If InStr(sLine, "Error") > 0 Then
                MsgBox "An error occurred: " & sLine, vbCritical
                Exit Sub
            End If
            
            ' Check if the script prompts to "Press any key to continue".
            If InStr(sLine, "Press any key") > 0 Then
                ' Send a newline (or any character) to simulate a key press.
                oExec.StdIn.WriteLine ""
            End If
        Loop
        DoEvents  ' Allow VBA to process events.
    Loop
    
    ' Read any remaining output after the process has terminated.
    Do While Not oExec.StdOut.AtEndOfStream
        sLine = oExec.StdOut.ReadLine
        Debug.Print sLine
    Loop
    
    ' Optionally, process any error output.
    If Not oExec.StdErr.AtEndOfStream Then
        Dim errLine As String
        Do While Not oExec.StdErr.AtEndOfStream
            errLine = oExec.StdErr.ReadLine
            Debug.Print "ERR: " & errLine
        Loop
    End If
    
    MsgBox "Process completed.", vbInformation
End Sub
