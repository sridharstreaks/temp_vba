Sub OpenCmdFileAndMonitorOutput()
    Dim wsh As Object
    Set wsh = CreateObject("WScript.Shell")
    
    Dim cmdFilePath As String
    ' Full path to your CMD file:
    cmdFilePath = "C:\YourFolder\YourScript.cmd"
    
    ' Build a command that opens CMD.exe with /k so that it stays open.
    ' This will "open" your CMD file in an interactive window.
    Dim command As String
    command = "cmd.exe /k """ & cmdFilePath & """"
    
    ' Launch the command prompt and run the CMD file.
    Dim oExec As Object
    Set oExec = wsh.Exec(command)
    
    Dim sLine As String
    ' Loop continuously while the process is running.
    Do While oExec.Status = 0
        ' Check any output from the process.
        Do While Not oExec.StdOut.AtEndOfStream
            sLine = oExec.StdOut.ReadLine
            Debug.Print sLine
            
            ' Look for the password prompt output.
            If InStr(sLine, "Enter password") > 0 Then
                Dim userPassword As String
                userPassword = InputBox("Please enter the password:", "Password Required")
                ' Send the password to the CMD process.
                oExec.StdIn.WriteLine userPassword
            End If
            
            ' Look for the "Press any key" prompt.
            If InStr(sLine, "Press any key") > 0 Then
                ' Simulate a key press by sending a newline.
                oExec.StdIn.WriteLine ""
            End If
        Loop
        DoEvents  ' Allow VBA to process other events.
    Loop
    
    ' Optionally, read any remaining output once the process ends.
    Do While Not oExec.StdOut.AtEndOfStream
        sLine = oExec.StdOut.ReadLine
        Debug.Print sLine
    Loop
End Sub
