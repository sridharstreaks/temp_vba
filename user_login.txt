Sub RunCommandInCmd(command As String)
  Dim objShell As Object
  Set objShell = VBA.CreateObject("WScript.Shell")

  ' Open cmd.exe and execute the command.
  ' /c carries out the string specified by command and then terminates
  objShell.Run "cmd /c " & command, 0, False ' 0 = Hidden, False = Don't wait for completion

  'If you want to wait for the command to finish and see the cmd window, use:
  'objShell.Run "cmd /k " & command, 1, True ' 1 = Normal window, True = Wait for completion

  Set objShell = Nothing
End Sub

' Example usage:
Sub Example()
  ' Run a simple command to list the directory contents.
  RunCommandInCmd "dir"

  ' Run a command that takes a file path (example). Be mindful of file paths and escaping quotes.
  ' RunCommandInCmd "type ""C:\My Documents\test.txt""" 'Example to display the contents of a text file.

  ' Run a command to create a directory.
  'RunCommandInCmd "md ""C:\NewFolder"""
End Sub

' Example usage with a variable file path:
Sub ExampleWithPath()
  Dim filePath As String
  filePath = "C:\My Documents\test.txt"

  RunCommandInCmd "type """ & filePath & """"

End Sub

' Example usage with a variable folder path:
Sub ExampleWithFolder()
    Dim folderPath As String
    folderPath = "C:\NewFolder"
    RunCommandInCmd "md """ & folderPath & """"
End Sub

' Example usage with a variable that includes spaces:
Sub ExampleWithSpaces()
    Dim myVariable As String
    myVariable = "This is a test with spaces"
    RunCommandInCmd "echo """ & myVariable & """"
End Sub

'Example with environment variables:
Sub ExampleEnvironmentVariable()
    RunCommandInCmd "echo %TEMP%"
End Sub


'Example to run a python script:
Sub RunPythonScript()
    Dim pythonPath As String
    Dim scriptPath As String

    'Adjust these paths to your python installation and script location.
    pythonPath = """C:\Path\To\Python\python.exe"""
    scriptPath = """C:\Path\To\Your\script.py"""

    RunCommandInCmd pythonPath & " " & scriptPath

End Sub
